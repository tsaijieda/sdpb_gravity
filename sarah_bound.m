(* ::Package:: *)

Import["/home/string-12/sdpb_gravity/SDPB2.m"]
mu1 = ToExpression[ReadList["/home/string-12/sdpb_gravity/range.txt"][[1]]];
spin = 0;
bound = ToExpression[ReadList["/home/string-12/sdpb_gravity/range.txt"][[2]]];
a1 = ToExpression[ReadList["/home/string-12/sdpb_gravity/range.txt"][[3]]]


nulllist = {5, -1, -1, -1};
num1 = 21/2;
list0 = Table[0, {i, 1, Total[nulllist]+Length[nulllist]}];
list1 = Table[0, {i, 3/2, num1, 1}];


Cimp2list[n_,x_,J_] = 2/x;
G[n_, D_, b_, mu_] := b^(num1+1)*mu^((1+n)/2) *(2^n Gamma[(D-2)/2]Gamma[(n+1)/2])/Gamma[(D-n-3)/2]*1/b^(n+1);
B[n_, D_, b_, mu_] := b^(num1+1)*mu^((1+n)/2) *(2^((D-3)/2) Gamma[(D-2)/2])/Sqrt[\[Pi]]*1/b^((D-1)/2);
F[n_, D_, b_, mu_] := b^(num1+1)*mu^((1+n)/2) *(2^((D-9)/2) Gamma[(D-2)/2])/Sqrt[\[Pi]] (-27 + 12D - D^2 - 8n)/b^((D-3)/2);
H[n_, D_, b_, mu_] := b^(num1+1)*mu^((1+n)/2)* Hypergeometric2F1[(1+n)/2,(D-2)/2,(3+n)/2,-(mu*b^2/4)]/(n+1);
Nlist[n_,x_,J_]:=1/x* {(20+91 J-36 J^2-14 J^3-J^4)/(20 x^2)-(2-7 J-J^2)/(2 x),(360-2142 J+1409 J^2+147 J^3-112 J^4-21 J^5-J^6)/(360 x^3)-(2-7 J-J^2)/(2 x),(10080+76104 J-64588 J^2+2450 J^3+6349 J^4+98 J^5-224 J^6-28 J^7-J^8)/(10080 x^4)-(2-7 J-J^2)/(2 x),-((J (7+J) (-23+7 J+J^2))/(20 x^4))-(2-7 J-J^2)/(2 x),(403200-3769920 J+3778144 J^2-504980 J^3-368780 J^4+41405 J^5+18207 J^6-70 J^7-370 J^8-35 J^9-J^10)/(403200 x^5)-(2-7 J-J^2)/(2 x),-((J (7+J) (540-371 J-4 J^2+14 J^3+J^4))/(360 x^5))-(2-7 J-J^2)/(2 x)}[[n+1]];
Nlist2[n_,x_,J_]:={(2-7 J-J^2)/(2 x),(20+91 J-36 J^2-14 J^3-J^4)/(20 x^2),(360-2142 J+1409 J^2+147 J^3-112 J^4-21 J^5-J^6)/(360 x^3),(10080+76104 J-64588 J^2+2450 J^3+6349 J^4+98 J^5-224 J^6-28 J^7-J^8)/(10080 x^4),-((J (7+J) (-23+7 J+J^2))/(20 x^4)),(403200-3769920 J+3778144 J^2-504980 J^3-368780 J^4+41405 J^5+18207 J^6-70 J^7-370 J^8-35 J^9-J^10)/(403200 x^5),-((J (7+J) (540-371 J-4 J^2+14 J^3+J^4))/(360 x^5))}[[n+1]];
coefflist = {{-((18 Sqrt[15])/(7Sqrt[mu])),(22 Sqrt[15])/(7 mu),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{-((90 Sqrt[6])/(11 Sqrt[mu])),(28 Sqrt[6])/mu,-((234 Sqrt[6])/(11 mu^(3/2))),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{-((6520 Sqrt[3/377])/(11 Sqrt[mu])),(3346 Sqrt[3/377])/mu,-((4692 Sqrt[39/29])/(11 mu^(3/2))),8470/(Sqrt[1131] mu^2),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{-((6956 Sqrt[210/7163])/(11 Sqrt[mu])),(26492 Sqrt[42/35815])/mu,-((86514 Sqrt[390/3857])/(11 mu^(3/2))),(49232 Sqrt[70/21489])/mu^2,-((1326 Sqrt[11310/133])/(11 mu^(5/2))),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{(392968 Sqrt[105/3573349])/(11 Sqrt[mu]),-((2075286 Sqrt[21/17866745])/mu),(9973116 Sqrt[195/1924111])/(11 mu^(3/2)),-((9331846 Sqrt[35/10720047])/mu^2),(933456 Sqrt[3315/113183])/(11 mu^(5/2)),-((45980 Sqrt[1995/188071])/mu^3),0,0,0,0,0,0,0,0,0,0,0,0,0,0},{-((338644 Sqrt[385/439521927])/Sqrt[mu]),(8670056 Sqrt[231/732536545])/mu,-((5188412 Sqrt[2145/78888551])/mu^(3/2)),(232560080 Sqrt[385/439521927])/(3 mu^2),-((12584732 Sqrt[3315/51045533])/mu^(5/2)),(4002008 Sqrt[7315/23132733])/mu^3,-((6188 Sqrt[1316497/128535])/mu^(7/2)),0,0,0,0,0,0,0,0,0,0,0,0,0},{(72824 Sqrt[55/1231599])/Sqrt[mu],-((2379706 Sqrt[33/2052665])/mu),(3453892 Sqrt[165/410533])/mu^(3/2),-((112738990 Sqrt[55/1231599])/(3 mu^2)),(524368 Sqrt[7905/8569])/mu^(5/2),-((4470928 Sqrt[1045/64821])/mu^3),(163088744 Sqrt[17/3984585])/mu^(7/2),-((5244 Sqrt[128535/527])/mu^4),0,0,0,0,0,0,0,0,0,0,0,0},{-((23900 Sqrt[1430/1612093])/Sqrt[mu]),(83148 Sqrt[10010/230299])/mu,-((761394 Sqrt[10010/230299])/mu^(3/2)),(10696336 Sqrt[10010/230299])/(3 mu^2),-((1398450 Sqrt[68510/33649])/mu^(5/2)),(10493800 Sqrt[14630/157573])/mu^3,-((853004 Sqrt[170170/13547])/mu^(7/2)),(1554288 Sqrt[48070/47957])/mu^4,-((3060 Sqrt[5275270/437])/mu^(9/2)),0,0,0,0,0,0,0,0,0,0,0},{(70232 Sqrt[33/162127])/Sqrt[mu],-((1484922 Sqrt[231/23161])/(5 mu)),(3343212 Sqrt[231/23161])/mu^(3/2),-((58671046 Sqrt[77/69483])/mu^2),(5172279648 Sqrt[3/1783397])/mu^(5/2),-((97785836 Sqrt[4389/1219])/(13 mu^3)),(10490114792 Sqrt[21/254771])/(5 mu^(7/2)),-((32363412 Sqrt[14421/371])/(13 mu^4)),(70681920 Sqrt[231/23161])/mu^(9/2),-((31464 Sqrt[100947/53])/mu^5),0,0,0,0,0,0,0,0,0,0},{-((290894 Sqrt[22/995923])/Sqrt[mu]),(51413068 Sqrt[22/995923])/(5 mu),-((139404318 Sqrt[22/995923])/mu^(3/2)),(69323968 Sqrt[946/23161])/(3 mu^2),-((46521956016 Sqrt[2/10955153])/mu^(5/2)),(7821053184 Sqrt[418/52417])/(13 mu^3),-((5296010272 Sqrt[418/52417])/(5 mu^(7/2))),(684598944 Sqrt[9614/2279])/(13 mu^4),-((16482739980 Sqrt[22/995923])/mu^(9/2)),(15372216 Sqrt[9614/2279])/mu^5,-((22431500 Sqrt[1166/18791])/mu^(11/2)),0,0,0,0,0,0,0,0,0},{(1605976 Sqrt[2002/1562340113])/Sqrt[mu],-((334016822 Sqrt[2002/1562340113])/(5 mu)),(7508798364 Sqrt[286/10936380791])/mu^(3/2),-((637388582 Sqrt[86086/36333491])/(3 mu^2)),(3622372041168 Sqrt[26/120300188701])/mu^(5/2),-((107117780946 Sqrt[2926/1068969551])/mu^3),(1007732470948 Sqrt[3458/904512697])/(5 mu^(7/2)),-((15541786266 Sqrt[67298/46476937])/mu^4),(522644024040 Sqrt[2002/1562340113])/mu^(9/2),-((5350360518 Sqrt[124982/25026043])/mu^5),(4253808340 Sqrt[58058/53873797])/mu^(11/2),-((37308438 Sqrt[5374226/582001])/(5 mu^6)),0,0,0,0,0,0,0,0},{-((432728 Sqrt[77/2577433])/Sqrt[mu]),(104602216 Sqrt[77/2577433])/(5 mu),-((2746894452 Sqrt[11/18042031])/mu^(3/2)),(11792410528 Sqrt[77/2577433])/(3 mu^2),-(1850455659204/(Sqrt[198462341] mu^(5/2))),(1250591188872 Sqrt[77/2577433])/(13 mu^3),-((14411054561036 Sqrt[7/28351763])/(5 mu^(7/2))),(109240267212912 Sqrt[77/2577433])/(221 mu^4),-((646173130620 Sqrt[77/2577433])/mu^(9/2)),(68369005092216 Sqrt[11/18042031])/(17 mu^5),-((11432151020 Sqrt[2233/88877])/mu^(11/2)),(126414045504 Sqrt[341/582001])/(5 mu^6),-((606100 Sqrt[6402011/31])/(3 mu^(13/2))),0,0,0,0,0,0,0},{(571000 Sqrt[70/20677])/(11 Sqrt[mu]),-((2885858 Sqrt[70/20677])/mu),(4812529188 Sqrt[10/144739])/(11 mu^(3/2)),-((2180304226 Sqrt[70/20677])/(3 mu^2)),(400096634400 Sqrt[10/144739])/(11 mu^(5/2)),-((319374645150 Sqrt[70/20677])/(13 mu^3)),(3483005596 Sqrt[1610/899])/mu^(7/2),-((1771053810702 Sqrt[1610/899])/(221 mu^4)),(13117273800 Sqrt[1610/899])/mu^(9/2),-((1807080020250 Sqrt[230/6293])/(17 mu^5)),(9636810500 Sqrt[2030/713])/mu^(11/2),-((15876931734 Sqrt[7130/203])/(11 mu^6)),(4732205360 Sqrt[2030/713])/(3 mu^(13/2)),-((98407764 Sqrt[49910/29])/(11 mu^7)),0,0,0,0,0,0},{(1109956 Sqrt[125970/89055839])/(11 Sqrt[mu]),-((31958472 Sqrt[25194/445279195])/mu),(1740666924 Sqrt[125970/89055839])/(11 mu^(3/2)),-((6337863280 Sqrt[41990/267167517])/mu^2),(191877535572 Sqrt[125970/89055839])/(11 mu^(5/2)),-((1247911230104 Sqrt[9690/1157725907])/mu^3),(80027555804 Sqrt[579462/19359965])/mu^(7/2),-((9705165739104 Sqrt[13110/855710453])/mu^4),(1659695944620 Sqrt[152490/73567867])/mu^(9/2),-((2145422399640 Sqrt[170430/65823881])/mu^5),(1975197471660 Sqrt[192270/58346929])/mu^(11/2),-((169155647568 Sqrt[17963322/624515])/(11 mu^6)),(109656759380 Sqrt[1217710/9212673])/mu^(13/2),-((4717893096 Sqrt[89816610/124903])/(11 mu^7)),(59723180 Sqrt[84021990/133517])/mu^(15/2),0,0,0,0,0},{(2022584 Sqrt[3230/4940129])/(11 Sqrt[mu]),-((65819418 Sqrt[646/24700645])/mu),(4062809244 Sqrt[3230/4940129])/(11 mu^(3/2)),-((16824399410 Sqrt[3230/4940129])/(3 mu^2)),(582064642848 Sqrt[3230/4940129])/(11 mu^(5/2)),-((334854803822 Sqrt[3230/4940129])/mu^3),(7443949642948 Sqrt[646/24700645])/mu^(7/2),-((81374565073890 Sqrt[190/83982193])/mu^4),(215015714844840 Sqrt[170/93862451])/mu^(9/2),-((336729693614730 Sqrt[190/83982193])/mu^5),(486425483385660 Sqrt[170/93862451])/mu^(11/2),-((42772535511966 Sqrt[20026/796795])/(11 mu^6)),(48221419478960 Sqrt[3230/4940129])/(3 mu^(13/2)),-((2550404038392 Sqrt[100130/159359])/(11 mu^7)),(52241280920 Sqrt[119510/133517])/mu^(15/2),-((19464900 Sqrt[431259910/37])/(11 mu^8)),0,0,0,0},{(848008 Sqrt[1615/32227])/(33 Sqrt[mu]),-((10322872 Sqrt[323/161135])/mu),(55129436 Sqrt[20995/2479])/(11 mu^(3/2)),-((10043725216 Sqrt[1615/32227])/(9 mu^2)),(10090077092 Sqrt[20995/2479])/(11 mu^(5/2)),-((257686946440 Sqrt[1615/32227])/(3 mu^3)),(100978718932 Sqrt[20995/2479])/(3 mu^(7/2)),-((2125892390160 Sqrt[1235/42143])/mu^4),(6562286001180 Sqrt[1105/47101])/mu^(9/2),-((12179908244920 Sqrt[1235/42143])/mu^5),(21259772067660 Sqrt[1105/47101])/mu^(11/2),-((71939520296256 Sqrt[4199/12395])/(11 mu^6)),(10137887952220 Sqrt[20995/2479])/(9 mu^(13/2)),-((99134069940528 Sqrt[1615/32227])/(11 mu^7)),(303975618520 Sqrt[59755/871])/(3 mu^(15/2)),-((798988826720 Sqrt[20995/2479])/(11 mu^8)),(2938380456 Sqrt[59755/871])/mu^(17/2),0,0,0},{(4424296 Sqrt[2090/93812797])/(3 Sqrt[mu]),-((660634814 Sqrt[418/469063985])/mu),(358344644 Sqrt[27170/7216369])/mu^(3/2),-((804317125262 Sqrt[2090/93812797])/(9 mu^2)),(907958257264 Sqrt[2470/79380059])/mu^(5/2),-((26165829558890 Sqrt[2090/93812797])/(3 mu^3)),(127959266449924 Sqrt[2470/79380059])/(3 mu^(7/2)),-((279744963011250 Sqrt[27170/7216369])/(17 mu^4)),(994990628955960 Sqrt[1430/137111011])/mu^(9/2),-((2151756501693890 Sqrt[27170/7216369])/(17 mu^5)),(4440347446857420 Sqrt[1430/137111011])/mu^(11/2),-((1646703562114902 Sqrt[5434/36081845])/mu^6),(3161937828512960 Sqrt[27170/7216369])/(9 mu^(13/2)),-((3623317490179716 Sqrt[2090/93812797])/mu^7),(167886356240840 Sqrt[77330/2535481])/(3 mu^(15/2)),-((681388709342740 Sqrt[2470/79380059])/mu^8),(125730417792 Sqrt[3170530/61841])/mu^(17/2),-((262145487240 Sqrt[165490/1184777])/mu^9),0,0},{-((1358690 Sqrt[201894/5358530957])/Sqrt[mu]),(134974212 Sqrt[201894/5358530957])/mu,-((2845914678 Sqrt[374946/2885362823])/mu^(3/2)),(338533806400 Sqrt[67298/16075592871])/mu^2,-((8956267890000 Sqrt[34086/31738991053])/mu^(5/2)),(13765033145600 Sqrt[201894/5358530957])/mu^3,-((75727642492320 Sqrt[238602/4534141579])/mu^(7/2)),(561874648908960 Sqrt[2624622/412194689])/(17 mu^4),-((2276780777128260 Sqrt[138138/7831699091])/mu^(9/2)),(39615760344225000 Sqrt[374946/2885362823])/(17 mu^5),-((312255079347098700 Sqrt[6006/180129079093])/mu^(11/2)),(8315419322886912 Sqrt[374946/2885362823])/mu^6,-((105198058535666240 Sqrt[38038/28441433541])/mu^(13/2)),(19440046701004608 Sqrt[201894/5358530957])/mu^7,-((386350500740000 Sqrt[7470078/144825161])/mu^(15/2)),(6451386544804800 Sqrt[238602/4534141579])/mu^8,-((12846502126260 Sqrt[43753314/24726247])/mu^(17/2)),(12246308786520 Sqrt[10259886/105445153])/mu^9,-((4173175980 Sqrt[3106485294/348257])/mu^(19/2)),0},{(2203000 Sqrt[100947/4995448159])/Sqrt[mu],-((241429126 Sqrt[100947/4995448159])/mu),(5623507308 Sqrt[187473/2689856701])/mu^(3/2),-((740306626370 Sqrt[33649/14986344477])/mu^2),(700834941600 Sqrt[528333/954465281])/mu^(5/2),-((37150660498500 Sqrt[100947/4995448159])/mu^3),(20750051900760 Sqrt[1312311/384265243])/mu^(7/2),-((111774252756780 Sqrt[1312311/384265243])/mu^4),(280295475932160 Sqrt[2141139/235517407])/mu^(9/2),-((326093244461400 Sqrt[5811663/86769571])/mu^5),(50115684033444000 Sqrt[93093/5416900361])/mu^(11/2),-((1548321464506896 Sqrt[5811663/86769571])/mu^6),(23064206427399040 Sqrt[589589/855300057])/mu^(13/2),-((5118719476180968 Sqrt[3129357/161143489])/mu^7),(144019828259792400 Sqrt[100947/4995448159])/mu^(15/2),-((2693628128769000 Sqrt[3698331/136352183])/mu^8),(8424646296863760 Sqrt[591261/852881393])/mu^(17/2),-((979910776620 Sqrt[1749310563/288271])/mu^9),(19793596363560 Sqrt[18329091/27512303])/mu^(19/2),-((228575100 Sqrt[155688640107/3239])/mu^10)}}/.{mu->mu1/3};


Poly[J_, x_, y_]:=PositiveMatrixWithPrefactor[
        DampedRational[1,{},1/E,y],{Simplify[{Flatten[x^10*{2/x+2(-1+(4J(J+7))/8)/x^2,(-1+(4J(J+7))/8)/x^2,Table[Simplify[Expand[Nlist[n,x,J]]],{n,0,nulllist[[1]]}]}]}]}];
PolyLargeJ[J_, x_, y_]:=PositiveMatrixWithPrefactor[
        DampedRational[1,{},1/E,y],{{Flatten[{Table[0,{n,3/2,num1}], Table[(1+10x)^5 * Nlist2[n,(1+10x)/(1+x),J],{n,0,nulllist[[1]]}]}]}}];
NewPoly[b_]:=PositiveMatrixWithPrefactor[
        DampedRational[1,{},1/E,x],{{Flatten[{Table[(G[i, 10, b, 1] + B[i, 10, b, 1]),{i,3/2,num1}], list0}],Flatten[{Table[(F[i, 10, b, 1]),{i,3/2,num1}], list0}]},
        {Flatten[{Table[(F[i, 10, b, 1]),{i,3/2,num1}], list0}],Flatten[{Table[(G[i, 10, b, 1] - B[i, 10, b, 1]),{i,3/2,num1}], list0}]}}];

Polydis[b_, x_]:=PositiveMatrixWithPrefactor[
        DampedRational[1,{},1/E,x],{{Flatten[{Table[H[n,10,b, 1],{n,3/2,num1}], list0}]}}]        
        (*        
Poly[J_, m_]:=PositiveMatrixWithPrefactor[
        DampedRational[1,{},1/E,x],{{{K[2, J, m], K[3, J, m], K[4, J, m], K[5, J, m], K[6, J, m], K[7, J, m]}}}];        
*)
LaunchKernels[];
TSDP[datfile_] := Module[

    {


        pols = 
        
        
       Flatten[{
       (*Flatten[N[ParallelTable[Poly[i, 1, x],{i, 0, 0, 2}],300]],*)
      Flatten[N[ParallelTable[Poly[i, mu1 + x, x],{i, 0, 40, 2}],300]]
       },1],

        (*norm =  1 * Flatten[{Table[(mu1^((1+n)/2) (-21 mu1 (1+n)+13 (3+n)-9 (3+n)*Hypergeometric2F1[1,(1+n)/2,(3+n)/2,-(mu1)]))/(2 (1+n) (3+n)),{n,3/2,num1}], list0}],*)
        (*norm =  -1 * N[Flatten[{Table[1/(i+3)*mu1^((i+3)/2),{i,3/2,num1}], list0}],300],*)
        norm =  1 * Flatten[{1,0, list0}],
		obj  = -1 * N[Flatten[{0,1, list0}],300]
        (*norm =  1 * N[Flatten[{Table[1/(i+3)*(mu1/3)^((i+3)/2),{i,3/2,num1}], list0}],300],
		obj  = -1 * N[Flatten[{Table[2 * g2 * 1/(i+1)*(mu1/3)^((i+1)/2) + 1/(i-1)*(mu1/3)^((i-1)/2),{i,3/2,num1}], list0}],300]*)

                (*
        norm =  {1/5, 1/6, 1/7, 1/8, 1/9, 1/10},
        obj  =  {1, 1/2, 1/3, 1/4, 1/5, 1/6}
        *)       
    },
    Print[norm];
    Print[obj];
    WritePmpJson[datfile, SDP[obj, norm, pols]]]

TSDP["out.json"]




 
